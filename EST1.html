<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini EST1 Memo</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f7f7f7; }
  h1, h2, h3 { text-align: center; }
  .btn { padding: 10px 20px; margin: 5px; font-size: 16px; cursor: pointer; width: 100%; }
  .correct { background: #4CAF50; color: white; }
  .wrong { background: #f44336; color: white; }
  #question-container { display:none; margin-top:20px; }
  #nav { display:flex; justify-content: space-between; margin-top:10px; }
  footer { text-align:center; margin-top:30px; font-size:14px; color:#555; }
</style>
</head>
<body>

<h1>Mini EST1 Memo</h1>
<h2>By Mr. M. Shahawy</h2>
<p style="text-align:center; font-style:italic;">Dedicated to Princess H'our Medhat</p>

<div id="sections">
  <h2>Select a Section</h2>
</div>

<div id="question-container">
  <h3 id="timer"></h3>
  <h3 id="question-text"></h3>
  <div id="options"></div>
  <div id="nav">
    <button class="btn" id="prev-btn">Previous</button>
    <button class="btn" id="next-btn">Next</button>
    <button class="btn" id="back-btn">Back</button>
  </div>
  <h3 id="score"></h3>
</div>

<footer>© 2025 Mr. M. Shahawy — Mini EST1 Memo</footer>

<script>
// Shuffle array helper
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

// Questions
const est1_memo = {
  "English": [
    {q: "Despite the heavy rain, the soccer match went ___.", options:["on","over","off","by"], a:"on"},
    {q: "Meaning of 'Break the ice'?", options:["Shatter glass","Start conversation","End fight","Make mistake"], a:"Start conversation"},
    {q: "Passive form: 'The chef ___ the cake yesterday.'", options:["was baked","was baking","baked","was baked by"], a:"baked"}
  ],
  "Math": [
    {q: "2x + 3 = 11. x = ?", options:["4","3","5","2"], a:"4"},
    {q: "Simplify: 3(2x - 4) + 5", options:["6x-7","6x-12","6x-5","6x-9"], a:"6x-7"},
    {q: "Area of triangle base=10, height=5?", options:["25","50","15","20"], a:"25"}
  ]
};

let currentSection = "";
let currentIndex = 0;
let score = 0;
let currentQuestions = [];
let timer;
let timeLeft = 300;

// Load sections
const sectionsDiv = document.getElementById("sections");
Object.keys(est1_memo).forEach(section => {
  const btn = document.createElement("button");
  btn.className="btn";
  btn.innerText = section;
  btn.onclick = ()=>startSection(section);
  sectionsDiv.appendChild(btn);
});

// Start timer
function startTimer() {
    clearInterval(timer);
    timeLeft = 300; // 5 minutes per section
    timer = setInterval(() => {
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        document.getElementById("timer").innerText = `Time Left: ${minutes}:${seconds.toString().padStart(2,'0')}`;
        timeLeft--;
        if(timeLeft < 0){
            clearInterval(timer);
            alert(`Time's up!\nScore: ${score}/${currentQuestions.length}\nBy Mr. M. Shahawy`);
        }
    }, 1000);
}

// Start section
function startSection(section){
  currentSection = section;
  currentIndex = 0;
  score = 0;

  // Deep copy & shuffle questions
  currentQuestions = JSON.parse(JSON.stringify(est1_memo[currentSection]));
  shuffleArray(currentQuestions);
  currentQuestions.forEach(q => shuffleArray(q.options));

  sectionsDiv.style.display="none";
  document.getElementById("question-container").style.display="block";
  startTimer();
  showQuestion();
}

// Show question
function showQuestion(){
  const q = currentQuestions[currentIndex];
  document.getElementById("question-text").innerText = q.q;
  const optionsDiv = document.getElementById("options");
  optionsDiv.innerHTML="";
  q.options.forEach(opt=>{
    const btn=document.createElement("button");
    btn.className="btn";
    btn.innerText=opt;
    btn.onclick = ()=>checkAnswer(btn,q.a);
    optionsDiv.appendChild(btn);
  });
  document.getElementById("score").innerText = `Score: ${score}/${currentIndex}`;
}

// Check answer
function checkAnswer(btn, correct){
  const buttons = btn.parentNode.children;
  for(let b of buttons){ b.disabled=true; }
  if(btn.innerText===correct){
    btn.classList.add("correct");
    score++;
  } else {
    btn.classList.add("wrong");
    btn.innerText += ` (Correct: ${correct})`;
  }
  document.getElementById("score").innerText = `Score: ${score}/${currentIndex+1}`;
}

// Navigation
document.getElementById("next-btn").onclick = ()=>{
  if(currentIndex < currentQuestions.length - 1){
    currentIndex++;
    showQuestion();
  } else {
    clearInterval(timer);
    const percentage = Math.round((score / currentQuestions.length) * 100);
    let grade;
    if(percentage >= 90) grade = 'A';
    else if(percentage >= 80) grade = 'B';
    else if(percentage >= 70) grade = 'C';
    else if(percentage >= 60) grade = 'D';
    else grade = 'F';
    alert(`Section complete!\nScore: ${score}/${currentQuestions.length}\nPercentage: ${percentage}%\nGrade: ${grade}\nBy Mr. M. Shahawy`);
  }
};
document.getElementById("prev-btn").onclick = ()=>{
  if(currentIndex>0){
    currentIndex--;
    showQuestion();
  }
};
document.getElementById("back-btn").onclick = ()=>{
  clearInterval(timer);
  document.getElementById("question-container").style.display="none";
  sectionsDiv.style.display="block";
};
</script>

</body>
</html>